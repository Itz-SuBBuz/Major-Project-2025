<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Major Project Blog DEE 2025</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f7f8;
      color: #333;
    }
    header {
      background-color: #00897b;
      color: white;
      padding: 30px 10px;
      text-align: center;
    }
    header h1 {
      margin-bottom: 10px;
    }
    nav {
      background: #004d40;
      padding: 12px;
      text-align: center;
    }
    nav a {
      color: white;
      margin: 0 15px;
      text-decoration: none;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
    }
    section {
      background: white;
      margin: 25px auto;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 900px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h2 {
      color: #00897b;
      border-bottom: 2px solid #80cbc4;
      padding-bottom: 5px;
    }
    img {
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }
    footer {
      text-align: center;
      padding: 15px;
      background-color: #004d40;
      color: white;
      margin-top: 30px;
    }
.image-container {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.image-container img {
  width: 18%;
  height: auto;
  cursor: pointer;
  border-radius: 8px;
  transition: transform 0.3s;
}

.image-container img:hover {
  transform: scale(1.05);
}

#overlay {
  position: fixed;
  display: none;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.8);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

#overlay img {
  max-width: 90%;
  max-height: 90%;
  border-radius: 10px;
}

  </style>
</head>
<body>

  <header>
    <h1>Smart Fan Control System</h1>
    <p> Major Project by DEE | 2023-26 | 
      Behala Government Polytechnic
    </p>
  </header>

  <nav>
    <a href="#overview">Overview</a>
    <a href="#objective">Objective</a>
    <a href="#components">Components</a>
    <a href="#working">Working</a>
    <a href="#software">Software</a>
    <a href="#features">Features</a>
    <a href="#results">Results</a>
    <a href="#gallery">Gallery</a>
    <a href="#credit">Credits</a>
  </nav>

  <section id="overview">
    <h2>Project Overview</h2>
    <p>
      The <strong>Smart Fan Control System</strong> is an IoT-based system designed to control a DC fan through a web interface on any smart device like mobile, laptop, tablet etc.
      This project enhances comfort and energy efficiency. while allowing remote operation via smartphone connectivity.
    </p>
  </section>

  <section id="objective">
    <h2>Objective</h2>
    <p>
      The goal of this project is to design and implement a fan control system that can smoothly vary the fan speed using Pulse Width Modulation (PWM)
      and be controlled wirelessly through a mobile app interface.
    </p>
  </section>

  <section id="components">
    <h2>Components & Materials Used</h2>
    <ul>
      <li>ESP8266 Microcontroller. <a href="https://www.nabto.com/esp8266-for-iot-complete-guide/" target="_blank">Click here</a></li>
      <li>Arduino nano. <a href="https://www.handsontec.com/dataspecs/arduino-nano.pdf" target="_blank">Click here</a></li>
      <li>Mini360 Dc-Dc buck converter. <a href="https://goughlui.com/2018/07/04/tested-mini-360-mp2307-based-3a-buck-converter-module/" target="_blank">Click here</a></li>
      <li>BTS7960 Motor Driver. <a href="https://www.ovaga.com/blog/transistor/bts7960-motor-driver-datasheet-and-circuit-diagram?srsltid=AfmBOor1aFt4cD0U9iwtDOHmr85wz-VqI-zavh7v_TAQAW6nkW9Ggy3N" target="_blank">Click here</a></li>
      <li>12V DC Motor. <a href="https://www.handsontec.com/dataspecs/motor_fan/775-Motor.pdf" target="_blank">Click here</a></li>
      <li>SMPS Power Supply. <a href="https://www.easyelectronics.in/index.php?route=product/product&product_id=146" target="_blank">Click here</a></li>
      <li>MG995 servo motor. <a href="https://www.mouser.com/catalog/specsheets/Soldered_109042.pdf?srsltid=AfmBOorKMpZ2kdiH6PgESDbgWnSAlqtnMNyaVlOg7h_4iBxkvCgvscf2" target="_blank">Click here</a></li>
      <li>Fan Blades and Housing</li>
      <li>Connecting Wires, Breadboard, Soldering Kit</li>
    </ul>
    <div class="image-container">
      <img src="esp8266.jpeg" alt="Image 1" onclick="showImage(this)">
      <img src="nano.jpg" alt="Image 2" onclick="showImage(this)">
      <img src="mini.jpg" alt="Image 2" onclick="showImage(this)">
      <img src="bts7960.jpg" alt="Image 2" onclick="showImage(this)">
  <img src="Dc Motor.jpg" alt="Image 3" onclick="showImage(this)">
  <img src="smps.jpg" alt="Image 4" onclick="showImage(this)">
</div>

<!-- Overlay for enlarged image -->
<div id="overlay" onclick="hideOverlay()">
  <img id="overlay-img" src="">
</div>

<script>
function showImage(img) {
  document.getElementById('overlay-img').src = img.src;
  document.getElementById('overlay').style.display = 'flex';
}

function hideOverlay() {
  document.getElementById('overlay').style.display = 'none';
}
</script>


  </section>

  <section id="working">
    <h2>Circuit Design & Working Principle</h2>
    <p>
     <b>Working Principle : </b><br>

The working of this system is based on user interaction through a web interface that communicates with the ESP8266 microcontroller, which generates a PWM (Pulse Width Modulation) signal to control the DC motor speed via the BTS7960 motor driver.<br>

At first, the user connects to the web interface hosted by the ESP8266. The interface provides control buttons such as ON/OFF and speed levels (30%, 60%, 100%). When the user selects any control option, a corresponding command is sent to the ESP8266 through the network.<br>

The ESP8266 receives this input and processes it to generate a PWM signal with a specific duty cycle. This PWM signal represents the average voltage that will be applied to the motor. A higher duty cycle corresponds to higher speed, while a lower duty cycle reduces the motor speed.<br>

The generated PWM signal is then fed into the BTS7960 motor driver module, which amplifies the control signal to a higher current suitable for driving the motor. The BTS7960 acts as a bridge between the low-power control circuit and the high-power motor, ensuring safe and efficient operation.<br>

Finally, the BTS7960 outputs the controlled voltage and current to the DC motor according to the PWM duty cycle. This allows smooth and efficient speed variation of the fan, with quick response to user inputs through the web interface.
<br><br><b>Circuit Design:<br><div style="position: relative; width: 100%; padding-top: calc(max(56.25%, 400px));">
  <iframe src="https://app.cirkitdesigner.com/project/fd96a6f2-8906-49f2-a262-c72777f63179?view=interactive_preview" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;"></iframe>
</div>
    </p>
  </section>

  <section id="software">
    <h2>Software & Programming</h2>
    <p>
      <h3>🧩 Microcontroller Programming</h3>
      <b>1. ESP8266 (NodeMCU) Programming:</b><br>

The ESP8266 hosts a web server accessible from any browser on mobile, tablet, or laptop.

It uses Wi-Fi connectivity to communicate with the user and sends real-time commands to the Arduino Nano.

Key Functions:

toggleFan() → Switches the fan ON/OFF.

updateSpeed(value) → Updates the fan speed via PWM.

toggleServo(state) → Controls the head tilt servo.

The PWM value is calculated using map(fanSpeed, 0, 100, 0, 1023) to match the ESP8266 PWM range.

Commands are sent to the Arduino Nano via digital pins or analog PWM input, ensuring smooth coordination between web interface and hardware control.<br><br>

<b>2. Arduino Nano Programming:</b><br>

Acts as the hardware controller, converting low-power signals from ESP8266 into 5V-compatible PWM signals for the BTS7960 motor driver.

Reads PWM input from ESP8266 using analogRead() and maps it to Nano’s PWM output range using map() function.

Handles the servo motor movement:

Moves between 60° and 120° to create a smooth oscillation for head tilt.

Uses millis() and servoSpeedDelay to make the servo movement gradual and avoid abrupt motion.

Ensures safety and reliability, making sure that when the fan is turned off, the servo automatically moves to the neutral 90° position.<br><br>

<b>3. Communication & Synchronization:</b><br>
The ESP8266 handles the user interface, network communication, and signal generation.

The Arduino Nano performs real-time control of fan speed and servo movement.

This separation allows modular programming, easy troubleshooting, and potential upgrades like:

Temperature-based auto-speed control

Integration with voice assistants

Energy monitoring<br><br>

<b>4. Programming Best Practices Applied:</b><br>

Modular functions: Each control task is handled in its own function for clarity.

Mapping & constraining values: Prevents invalid PWM values and ensures smooth fan operation.

Non-blocking servo control: Using millis() avoids delays that could slow down fan control.

Real-time monitoring: Serial.print() statements in both controllers help in debugging and monitoring the system live.<br><br>
    </p>

    <section id="microcontroller-code">
      <h2>Microcontroller Code</h2>
      <div class="code-card">
        <div class="code-header">ESP8266 Code</div>
        <pre>
#include <ESP8266WiFi.h>
#include <ESP8266WebServer.h>

const char* ssid = "subuz_";        
const char* password = "SMwifi@24"; 

ESP8266WebServer server(80);

bool fanState = false;
int fanSpeed = 0;
bool servoState = false;

const int fanPin = D1;   
const int servoPin = D2; 

String buildHTML() // Web page code goes here

void setup() {
  Serial.begin(115200);
  pinMode(fanPin, OUTPUT);
  analogWriteRange(1023);
  analogWriteFreq(5000);
  pinMode(servoPin, OUTPUT);
  digitalWrite(servoPin, LOW);

  WiFi.begin(ssid, password);
  Serial.print("Connecting to Wi-Fi");
  while (WiFi.status() != WL_CONNECTED) { delay(500); Serial.print("."); }
  Serial.println("\n✅ Connected!");
  Serial.print("IP Address: "); Serial.println(WiFi.localIP());

  server.on("/", []() { server.send(200, "text/html", buildHTML()); });

  server.on("/fan/on", []() {
    fanState = true;
    int pwmVal = map(fanSpeed, 0, 100, 0, 1023);
    analogWrite(fanPin, pwmVal);
    Serial.println("FAN:ON");
    server.send(200, "text/plain", "OK");
  });

  server.on("/fan/off", []() {
    fanState = false;
    analogWrite(fanPin, 0);
    servoState = false;
    digitalWrite(servoPin, LOW);
    Serial.println("FAN:OFF + SERVO LOCK AT 90");
    server.send(200, "text/plain", "OK");
  });

  server.on("/speed", []() {
    fanSpeed = server.arg("val").toInt();
    fanSpeed = constrain(fanSpeed, 0, 100);
    if (fanState) {
      int pwmVal = map(fanSpeed, 0, 100, 0, 1023);
      analogWrite(fanPin, pwmVal);
    }
    Serial.print("SPD:"); Serial.println(fanSpeed);
    server.send(200, "text/plain", "OK");
  });

  server.on("/servo", []() {
    servoState = (server.arg("state") == "on");
    digitalWrite(servoPin, servoState ? HIGH : LOW);
    Serial.print("SERVO:"); Serial.println(servoState ? "ON" : "OFF");
    server.send(200, "text/plain", "OK");
  });

  server.begin();
  Serial.println("HTTP server started");
}

void loop() {
  server.handleClient();
}

</pre>
</div>

</body>
</html>
        </pre>
      </div>

      <div class="code-card">
        <div class="code-header">Arduino Nano Code</div>
        <pre>
          #include <Servo.h>

// --- Pins ---
// Fan PWM input from ESP8266 (0-3.3V)
const int fanPWMInput = A0;

// Nano PWM output to BTS7960
const int fanPWMOut = 5;

// BTS7960 direction pins
const int motorL = 6; 
const int motorR = 7;

// Servo control input from ESP8266 D2
const int servoControlPin = 2;

// Servo pin
const int servoPin = 9;

// --- Servo setup ---
Servo tiltServo;
int servoAngle = 90;        // Start at neutral
bool servoDirection = false; // false=up(60->120), true=down
unsigned long lastServoTime = 0;
const int servoSpeedDelay = 20; // ms per 1 degree for smooth tilting

void setup() {
  Serial.begin(9600);

  // Motor pins
  pinMode(fanPWMOut, OUTPUT);
  pinMode(motorL, OUTPUT);
  pinMode(motorR, OUTPUT);

  // Servo control pin
  pinMode(servoControlPin, INPUT);

  // Initialize servo
  tiltServo.attach(servoPin);
  tiltServo.write(servoAngle); // start neutral
}

void loop() {
  // -------------------
  // FAN PWM CONTROL
  // -------------------
  int pwmVal = analogRead(fanPWMInput); // read 0-1023 (0–3.3V input)

  // Map 0-3.3V input to 0-5V PWM output (Nano analogWrite 0-255)
  // 3.3V corresponds to ~682 in Nano ADC scale (1023 * 3.3/5)
  int pwmOut = map(pwmVal, 0, 682, 0, 255);
  pwmOut = constrain(pwmOut, 0, 255);

  analogWrite(fanPWMOut, pwmOut); // send PWM to BTS7960

  // Set motor direction (adjust as needed)
  digitalWrite(motorL, HIGH);
  digitalWrite(motorR, HIGH);

  // -------------------
  // SERVO CONTROL
  // -------------------
  bool servoActive = digitalRead(servoControlPin);

  if (servoActive) {
    // Smooth tilting cycle 60°-120°
    unsigned long now = millis();
    if (now - lastServoTime >= servoSpeedDelay) {
      lastServoTime = now;
      if (!servoDirection) {
        servoAngle++;
        if (servoAngle >= 120) servoDirection = true;
      } else {
        servoAngle--;
        if (servoAngle <= 60) servoDirection = false;
      }
      tiltServo.write(servoAngle);
    }
  } else {
    // Move servo to neutral 90° when OFF
    if (servoAngle < 90) servoAngle++;
    else if (servoAngle > 90) servoAngle--;
    tiltServo.write(servoAngle);
  }
}


    </pre>
  </section>

  <section id="features">
    <h2>Features</h2>
   <b>1. Wifi enabled control system</b><br>

Feature: You can control your fan over Wi-Fi using any browser on your phone or computer.

How it works: ESP8266 connects to your home Wi-Fi network. Once connected, it hosts a mini web server. You visit the IP address of the ESP8266 to access the fan control webpage.

Benefit: No physical switches needed; control your fan remotely.<br><br>

<b>2. Fan ON/OFF Toggle</b><br>

Feature: A large circular button on the webpage allows you to turn the fan on or off.

How it works:

Pressing the button sends a request to ESP8266 (/fan/on or /fan/off).

The ESP updates the digital/analog output to power the fan.

Visual Feedback: Button changes color:

Blue → ON

Red → OFF

Benefit: Instant feedback on fan state, easy for anyone to use.<br><br>

<b>3. Fan Speed Control (PWM)</b><br>

Feature: You can control fan speed using a slider (0–100%).

How it works:

The slider sends the value to the ESP (/speed?val=XX).

ESP converts this percentage into PWM signal (0–1023) for speed control.

Hardware: Uses analogWrite() to control fan voltage.

Benefit: Smooth speed adjustment rather than just ON/OFF.<br><br>

<b>4. Servo (Fan Head Tilt)</b><br>

Feature: Toggle a servo motor to adjust fan head tilt.

How it works:

The webpage has a switch toggle labeled “Head Tilt.”

ESP receives /servo?state=on/off and powers the servo accordingly.

Benefit: Adds automatic tilting capability (optional for smart fans).<br><br>

<b>5. Real-time Status Display</b><br>
Feature: The webpage shows current Fan State, Tilt State, and Speed.

How it works:

Updates happen using JavaScript after any action (ON/OFF, slider move, servo toggle).

Users see changes immediately without refreshing the page.

Benefit: User-friendly, no confusion about current settings.<br><br>

<b>6. Mobile-Friendly Web Interface</b><br>

Feature: Designed to be responsive on smartphones and tablets.

How it works:

CSS ensures layout scales for smaller screens (meta viewport).

Buttons, sliders, and switches are touch-friendly.

Benefit: Comfortable control from your phone anywhere at home.<br><br>

<b>7. Energy-Efficient Control</b><br>

Feature: Using PWM (Pulse Width Modulation) to adjust fan speed.

How it works:

Only supplies as much power as needed to achieve the selected speed.

Benefit: Saves energy compared to running the fan at full voltage all the time.<br><br>

<b>8. Safe Defaults</b><br>
Feature: When turning off the fan:

Fan speed is zero

Servo is locked to a safe position

Benefit: Prevents fan from moving unexpectedly or drawing power unnecessarily.

Optional Enhancements for Future Versions

Add temperature/humidity sensor to auto-adjust fan speed.

Add schedule control (fan turns on/off at specific times).

Add voice control using Alexa or Google Home.<br><br>
  </section>

  <section id="results">
    <h2>Results & Testing</h2>
    <p>
<b>🔹 1. System Setup</b><br>

The project setup consisted of:

ESP8266 (NodeMCU) as the main microcontroller and Wi-Fi web server.

BTS7960 43A motor driver connected to a 12V DC motor (acting as the fan).

Servo motor for tilt control.

Web interface hosted by ESP8266 for wireless fan control (via mobile or laptop).

SMPS (12V, 5A) as the power supply.

Connections were properly made — the motor driver was connected to ESP8266 PWM pins for speed control, and the servo was connected to a digital pin for tilt movement.<br><br>

<b>🔹 2. Web Interface Testing</b><br>

Once the ESP8266 was powered ON:

The module connected to Wi-Fi (subuz_ network).

The IP address was displayed on the Serial Monitor (e.g., 192.168.1.20).

Opening this IP in a web browser loaded the Fan Control Dashboard, containing:

ON/OFF toggle button

Speed control slider (0–255 PWM)

Tilt/Servo control button

<br>✅ Result:
The web interface worked smoothly and was responsive on both mobile and desktop browsers.
Each command was executed almost instantly, with negligible delay.<br><br>

<b>🔹 3. Motor Speed Control Testing</b><br>

PWM signals from the ESP8266 were sent to the BTS7960 inputs.

The fan speed changed smoothly as the slider on the web page was moved.

The motor ran steadily without jerks or vibration even at low PWM values.

The response was almost real-time, showing stable speed variation.

<br>✅ Result:
Speed control worked effectively through PWM, providing precise and stable fan operation.<br><br>

<b>🔹 4. Tilt Control Testing</b><br>

A servo motor connected to D2 was used for automatic tilt adjustment.

When the tilt ON button was pressed → servo started sweeping continuously.

When the tilt OFF button was pressed → servo stopped and automatically locked at 90°.

<br>✅ Result:
Tilt control was accurate, smooth, and reliable. The servo stopped firmly at the locked position after fan shutdown.<br><br>

<b>🔹 5. Safety and Stability</b><br>

The BTS7960 driver stayed within safe temperature limits even under continuous use.

Power draw was stable (~2.5A at full load).

Wi-Fi connection remained steady throughout long-duration tests.

After power interruptions, the system restarted safely with the fan turned OFF by default.

<br>✅ Result:
The overall system performance was reliable, stable, and safe for continuous operation.<br><br>

<b>🔹 6. Overall Outcome</b><br>
Feature	Test	Result<br>
Wi-Fi connection	Auto reconnect	✅<br>
Fan ON/OFF	Web toggle	✅<br>
Speed control	Real-time PWM	✅<br>
Tilt control	Servo function	✅<br>
Responsiveness	< 0.3s delay	✅<br>
Energy efficiency	PWM optimized	✅<br>
✅ Final Result<br>

The Smart Fan Control System successfully enabled wireless operation of a DC fan, providing real-time speed control and automatic tilt adjustment through an ESP8266-hosted web dashboard.
The system was low-cost, responsive, and energy-efficient, making it a smart and scalable home automation prototype.<br>
    </p>
    <p><strong>Future Scope:</strong> Integration with voice assistants and temperature-based auto control.</p>
  </section>

  <section id="gallery">
    <h2>Project Gallery</h2>
    <img src="https://via.placeholder.com/700x400" alt="Project Setup Image">
    <img src="https://via.placeholder.com/700x400" alt="Working Demo Image">
  </section>

  <section id="credit">
    <h2>Credits</h2>
    <p><strong>Developed By:</strong> DEE 2023-26</p>
    <p><strong>College:</strong> Behala Government Polytechnic</p>
    <p><strong>Department:</strong> Electrical Engineering</p>

  </section>

  <footer>
    <p>© 2025 Smart Fan Project | Designed by DEE | 2023-26 | Behala Goverment Polytechnic</p>
  </footer>

</body>
</html>
